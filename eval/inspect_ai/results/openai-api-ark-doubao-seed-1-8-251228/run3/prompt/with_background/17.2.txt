PROBLEM DESCRIPTION:
You will be provided with problem steps along with background knowledge necessary for solving the problem. Your task will be to develop a Python solution focused on the next step of the problem-solving process.

PROBLEM STEPS AND FUNCTION CODE:
Here, you'll find the Python code for the initial steps of the problem-solving process. This code is integral to building the solution.

Assume the energy on the iso-value surface is $\varepsilon_0 = E$ and the energies at the tetrahedron vertices are $\varepsilon_i$, with $\varepsilon_1 < \varepsilon_2 < \varepsilon_3 < \varepsilon_4$. Define the energy differences $\varepsilon_{ji} = \varepsilon_j - \varepsilon_i$. Write a function that initializes a 5x5 array $\{\varepsilon_{ji}\}, (i,j = 0,...,4)$, and creates sympy representations and corresponding variables for $\{\varepsilon_{ji}\}$.
Background
Generally, the integration of a quantity over the Brillouin zone can be expressed as the integral:
\begin{equation}
    \frac{1}{\Omega_{BZ}}\int_{BZ} \,M_{\mathbf{k}}\cdot
    f(\varepsilon_\mathbf{k})\,\mathrm{d}\mathbf{k}
\end{equation}
where $M_{\mathbf{k}}$ is the matrix element and $f(\varepsilon_\mathbf{k})$ is Heaviside step function $\Theta(E - \varepsilon_\mathbf{k})$ or Dirac function $\delta(E - \varepsilon_\mathbf{k})$.

Coordinate definition
In the linear tetrahedron method, the quantities, $M_\mathrm{k}$ and $\varepsilon_\mathbf{k}$, are linearly interpolated within the tetrahedron, i.e.
\begin{equation}
\varepsilon(x, y, z) = a + b\cdot x + c\cdot y + d\cdot z
\end{equation}
where x, y, z are the three component of $\mathbf{k}$. With the values at the four vertices, e.g. $\varepsilon_i (i=1,...,4)$, the coeffiecients a, b, c and d can be readily obtained. One can also use the Barycentric coordinates of the tetrahedron and express the quantity as
\begin{equation}
\varepsilon(e, u, v) =
\varepsilon_1\cdot(1 - e - u - v)
+ \varepsilon_2 \cdot e
+ \varepsilon_3 \cdot u
+ \varepsilon_4 \cdot v
\end{equation}

where
\begin{align}
x &= x_1\cdot(1 - e - u - v) + x_2 \cdot e + x_3 \cdot u + x_4 \cdot v \\
y &= y_1\cdot(1 - e - u - v) + y_2 \cdot e + y_3 \cdot u + y_4 \cdot v \\
z &= z_1\cdot(1 - e - u - v) + z_2 \cdot e + z_3 \cdot u + z_4 \cdot v \\
\end{align}

and $e, u, v \in [0, 1]$.

Now the contribution within the tetrahedron to the BZ integration becomes
\begin{equation}
    \frac{1}{\Omega_{BZ}}\int_{BZ}\,
    M(e, u, v)
    \cdot
    f(\varepsilon(e, u, v))
    \cdot
    \frac{\partial(x, y, z)}{\partial(e, u, v)}
    \, \mathrm{d}e \mathrm{d}u \mathrm{d}v
\end{equation}

where $\frac{\partial(x, y, z)}{\partial(e, u, v)}$ is the Jacobi determinant and one can readily show that it equals to $6\Omega_T$ where $\Omega_T$ is the volume of the tetrahedron


Integral for the density of states (DOS)
For the density of states (DOS), the quantity $M_\mathbf{k} =1$ and $f(\varepsilon_\mathbf{k})$ is the Dirac function. In this case, the contribution of the i-th tetrahedron $T_i$ to the DOS is
\begin{align}
\rho(E) &= \frac{1}{\Omega_{BZ}}\int_{T_i}\,
     \delta(E - \varepsilon(e, u, v))
     \cdot
     \frac{\partial(x, y, z)}{\partial(e, u, v)}
     \, \mathrm{d}e \mathrm{d}u \mathrm{d}v \\[9pt]
    &= \frac{6\Omega_T}{\Omega_{BZ}}\int_{T_i}\,
     \frac{1}{|\nabla \varepsilon(e, u, v)|}
    \, \mathrm{d}S\Bigr|_{\varepsilon = E}
\end{align}

where the volume integration over the BZ becomes a surface integration on an iso-value plane. Moreover, let us assumed $\varepsilon_i$ is ordered according to increasing values, i.e. $\varepsilon_1 < \varepsilon_2 < \varepsilon_3 < \varepsilon_4$ and denote $\varepsilon_{ji} = \varepsilon_j - \varepsilon_i$, where $\varepsilon_0 = E$.

The norm of the derivative can be derived from the above Barycentric coordinates transformation
\begin{equation}
|\nabla\varepsilon(e, u, v)| = \sqrt{\varepsilon_{21}^2+\varepsilon_{31}^2+\varepsilon_{41}^2}
\end{equation}


def init_eji_array(energy, energy_vertices):
    '''Initialize and populate a 5x5 array for storing e_ji variables, and map e_ji values
    to sympy symbols for later evaluation.
    Inputs:
    - energy: A float representing the energy level for density of states integration.
    - energy_vertices: A list of floats representing energy values at tetrahedron vertices.
    Outputs:
    - symbols: A dictionary mapping sympy symbol names to symbols.
    - value_map: A dictionary mapping symbols to their actual values (float).
    '''
    # Process energy values: ε0 = E (input energy), ε1-ε4 sorted vertex energies
    eps0 = energy
    sorted_vertices = sorted(energy_vertices)
    eps = [eps0] + sorted_vertices
    eps_array = np.array(eps)
    
    # Create 5x5 array of energy differences e_ji = ε_j - ε_i
    eji_array = eps_array[:, np.newaxis] - eps_array[np.newaxis, :]
    
    # Initialize symbol dictionary and value mapping
    symbols = {}
    value_map = {}
    
    # Create sympy symbols and map to their numerical values
    for j in range(5):
        for i in range(5):
            sym_name = f'e_{j}{i}'
            sym = sp.Symbol(sym_name)
            symbols[sym_name] = sym
            value_map[sym] = float(eji_array[j, i])
    
    return symbols, value_map


NEXT STEP - PROBLEM STEP AND FUNCTION HEADER:
This part will describe the next step in the problem-solving process. A function header will be provided, and your task is to develop the Python code for this next step based on the provided description and function header.

Write a function to perform DOS integration within a single tetrahedron. Consider the different scenarios where the magnitude of energy $E$ on the iso-value surface compares to the energies $\varepsilon_i$ at the vertices.
Background

Iso-surface integral
For different values of the energy E, the shapes of the iso-value surfaces intersected with the tetrahedron are different. Write codes to express the results of the surface integration using $\varepsilon_0 = E, \varepsilon_1, \varepsilon_2, \varepsilon_3, \varepsilon_4$ and $\varepsilon_{ji} = \varepsilon_j - \varepsilon_i$.



def integrate_DOS(energy, energy_vertices):
    '''Input:
    energy: a float number representing the energy value at which the density of states will be integrated
    energy_vertices: a list of float numbers representing the energy values at the four vertices of a tetrahedron when implementing the linear tetrahedron method
    Output:
    result: a float number representing the integration results of the density of states
    '''

    return result

DEPENDENCIES:
Use only the following dependencies in your solution. Do not include these dependencies at the beginning of your code.

import sympy as sp
import numpy as np

RESPONSE GUIDELINES:
Now, based on the instructions and information provided above, write the complete and executable Python program for the next step in a single block.
Your response should focus exclusively on implementing the solution for the next step, adhering closely to the specified function header and the context provided by the initial steps.
Your response should NOT include the dependencies and functions of all previous steps. If your next step function calls functions from previous steps, please make sure it uses the headers provided without modification.
DO NOT generate EXAMPLE USAGE OR TEST CODE in your response. Please make sure your response python code in format of ```python```.